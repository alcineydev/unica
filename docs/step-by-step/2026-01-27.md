# Step-by-step - 2026-01-27

## Contexto
- Projeto UNICA (Next.js 15, React 19, TypeScript, Tailwind, shadcn/ui).
- Objetivo: corrigir UX da sidebar admin e limpar headers; refatorar sidebar admin para flyout em desktop e inline fechado em mobile.

## Alterações desta sessão
1. `src/contexts/sidebar-context.tsx`
   - Criado contexto global para estado colapsado/expandido da sidebar com ações toggle/collapse/expand.
   - Adicionado estado/controladores para mobile (isMobileOpen, open/close/toggle).

2. `src/components/admin/admin-layout-client.tsx`
   - Wrapper client para prover o contexto e aplicar padding dinâmico (`pl-64` ↔ `pl-20`) conforme estado da sidebar.

3. `src/app/(admin)/layout.tsx`
   - Layout server simplificado para usar `AdminLayoutClient` mantendo checagem de sessão/role.

4. `src/components/admin/sidebar.tsx`
   - Sidebar colapsável com transição suave (`w-64` ↔ `w-20`), tooltips em modo colapsado, toggle no rodapé, labels/chevrons condicionais, popover fixed preservado e integração com estado mobile do contexto (sem botão flutuante).

5. `src/components/admin/header.tsx`
   - Botão de menu mobile integrado ao header usando `toggleMobile`; alinhamento `justify-between`; aria-label em notificações.

6. `src/components/parceiro/header.tsx`
   - Sem novas alterações nesta etapa.

## Função dos arquivos tocados
- `src/contexts/sidebar-context.tsx`: provê estado global colapsado/expandido e ações.
- `src/components/admin/admin-layout-client.tsx`: aplica contexto e padding dinâmico no layout.
- `src/app/(admin)/layout.tsx`: layout server que injeta o wrapper client após validar sessão/role.
- `src/components/admin/sidebar.tsx`: navegação principal do painel admin, agora colapsável com popover.
- `src/components/admin/header.tsx`: header do painel admin com notificações e menu de usuário.
- `src/components/parceiro/header.tsx`: header do painel parceiro com CTA de vendas, notificações e menu de usuário.

## Próximos passos sugeridos
- Validar visual no mobile para confirmar espaçamento do hamburger.
- Testar navegação entre submenus confirmando a restauração suave do scroll.
- Homologar UX do popover em desktop (abrir/fechar, clique fora, destaque de ativo).
- Validar transição colapsar/expandir (tooltips, chevrons escondidos, padding do layout).
